CONF_VERSION = "2"

DISTRO ?= "poky"

USER_CLASSES ?= "buildstats"

PACKAGECONFIG:append:pn-qemu-system-native = " sdl"

# Build the companion debug file system
IMAGE_GEN_DEBUGFS = "1"
# But with devtool ide the dbg tar is not needed
IMAGE_FSTYPES_DEBUGFS = ""

# ssh is mandatory, no password simplifies the usage
EXTRA_IMAGE_FEATURES += "\
    ssh-server-openssh \
    debug-tweaks \
"

# Remote debugging needs the gdbserver on the target device
IMAGE_INSTALL:append = " gdbserver"

# Remote debugging works much better if the binaries are in the rootfs as well.
IMAGE_CLASSES += "image-combined-dbg"

# Test setup for devtool ide plugin
IMAGE_INSTALL:append = " \
    ldd \
    ptest-runner \
    cmake-example-ptest \
    meson-example-ptest \
    autotools-example-ptest \
"

# clang recipes from meta-clang can provide llvm and related packages too.
# Use it as the provider for llvm and clang to save some compile time and space
PREFERRED_PROVIDER_llvm = "clang"
PREFERRED_PROVIDER_llvm-native = "clang-native"
PREFERRED_PROVIDER_nativesdk-llvm = "nativesdk-clang"
PROVIDES:pn-clang = "llvm"
PROVIDES:pn-clang-native = "llvm-native"
PROVIDES:pn-nativesdk-clang = "nativesdk-llvm"
